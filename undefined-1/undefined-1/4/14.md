# 14장 컴포넌트 결합

## ADP: 의존성 비순환 원칙

### 순환? 비순환?

> 컴포넌트 의존성 그래프에 순환이 있어서는 안된다.

이 말을 이해려면 '비순환'을 풀어서 이해해보는 것이 필요한 것 같다. 어느 컴포넌트에서 시작하더라도 의존성 관계를 따라가면서 최초의 컴포넌트로 돌아갈 수 없을때 순환이 없다고 할 수 있다.

컴포넌트들을 의존성 그래프로 표현 했을 때 돌아갈 수 없도록 즉, 순환할 수 없도록 의존 관계를 만드는 것이 의존성 비순환이다.



### 순환 구조면 무엇이 문제인가?

순환 구조가 되어버리면 컴포넌트가 강하게 결합해버린다. A 라는 컴포넌트가 B에 단방향 의존하고 있고 비순환 구조인 경우와 A -> B -> C -> D -> B 인 경우를 비교해보면 후자가 변경 하나에 대한 고려해야할 컴포넌트가 엄청 많아져 버린다. 사실상 B,C,D 는 하나의 거대한 컴포넌트가 되는 것이기 때문이다.



### 순환 끊기

그래서 이러한 경우 순환을 끊기 위해서 DIP 를 사용할 수 있다.



## SDP: 안정된 의존성 원칙

> 안정성의 방향으로(더 안정된 쪽에) 의존하라.

의존 관계를 세울 때 안정성이 큰 곳으로 의존하도록 의존 방향을 잘 고민하라는 것이다. 안정성에 대한 정의가 재미있는데 아래에 마저 정리한다.



### 안정성

안정성을 흔히 '변화 정도' 와 연관지어 생각하는데 저자는 이를 부정한다. 변화의 발생 빈도와 안정성은 직접 관련이 없고, 변경을 만들기 위해 필요한 작업량이 안정성과 직결되어 있다고 한다.

즉, 비즈니스의 변화 발생 빈도가 높은게 안정성이 낮은게 아니고 바꾸는데 비용이 너무 많이 들어서 바꾸지 못하는 것이 결과적으로 안정성이라는 것이다. 사전에서도 '쉽게 움직이지 않는'의 의미라고 하는데 이렇게 보면 말은 맞다.



### 안정성은 어떻게 높아질까

많은 컴포넌트가 의존하게 만들면 해당 컴포넌트는 변경이 어려워지니까 안정성이 높아진다. 이게 참 결과론적인 이야기인테 참신한 뷰라고 생각이 든다.



## SAP: 안정된 추상화 원칙

> 컴포넌트는 안정된 정도만큼만 추상화되어야 한다.

위에서 정리한 바와 같이 안정성이 큰 컴포넌트일 수록 변경이 어렵다. 그래서 변경을 자주 하면 안되는 고수준 정책을 다루는 것은 안정성이 큰 컴포넌트에 위치 시켜야 한다.

하지만 한편으로는 그만큼 그 컴포넌트는 변경이 어려워진다. 왜냐면 안정성이 크기(=변경하는데 비용이 많이 들기) 때문이다.

그래서 안정성을 지키면서도 변경에 유연하게 대처하기 위한 고민을 하게 되고, 이를 해결하기 위한 방법으로 추상클래스를 말하고 있다.



### 안정화된 추상화 원칙이란

안정화된 컴포넌트는 추상 컴포넌트여야 하며, 이를 통해서 안정성이 컴포넌트를 확장하는 일을 방해하면 안된다는 의미이다. 다시 정리해보자.

1. 고수준의 정책은 안정성이 큰 컴포넌트에 위치 해야한다. 자주 변해선 안되기 때문이다.
2. 하지만 안정성이 큰 컴포넌트에 위치하면 변경이 정말 어려워진다.
3. 그래서 안정성을 챙기되 유연함도 가져갈 수 있도록 추상 클래스를 사용해야 한다.



### 주계열

<figure><img src="../../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

저자는 저 주계열에 위치한 컴포넌트가 가장 이상적이라고 주장하고 있다. 주계열은 안정성에 비해서 너무 추상적이지도 않고, 추상화 정도에 비해서 너무 불안정 하지도 않은 것을 의미한다.



고통의 구역은 안정성은 매우 큰데 추상화 정도가 너무 낮은 경우이다. 그래서 한번 고치려면 많은 비용을 지불해야 한다.



쓸모없는 구역의 경우 엄청나게 추상화 되어 있지만, 그 누구도 해당 컴포넌트에 의존하지 않는 것을 의미한다. 말 그대로 쓸모가 없는 것이다. 왜? 의존하는 것이 없으니까.
