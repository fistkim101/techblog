# CH06 객체 지도

## 도메인 모델이 결국 근본이며 설계는 도메인 모델을 지도로 삼아야한다

이번 챕터의 핵심은 '설계시 단건 단건들의 기능(유스케이스)들을 근거로 삼지 말고 근본이라 할 수 있는 도메인 모델을 근거로 삼아야한다' 는 것이다.

어찌보면 당연스럽게 행하던 것들인데 의식적으로 거기에 의미를 붙이고, 당연시 여겼던 것에 왜? 라는 질문과 답을 해보는 챕터라 할 수 있다.

처음에는 왜 자꾸 당연한 이야기를 이렇게 복잡하게 하지 싶었는데, 반대로 내가 이것에 대해서 질문을 받았을 때 명확하게 책에서 말하는 것처럼 체계적으로 대답하지 못할 것 같다는 생각이 들어서 수긍하게 되었다.

> 기능을 중심으로 구조를 종속시키는 접근법은 범용적이지 않고 재사용이 불가능하며 변경에 취약한 모델을 낳게 된다. 이와 달리 안정적인 구조를 중심으로 기능을 종속시키는 접근법은 범용적이고 재사용 가능하며 변경에 유연하게 대처할 수 있는 모델을 만든다.

## 기능 설계 vs 구조 설계

### 훌륭한 설계란

> 미래를 대비하는 가장 좋은 방법은 변경을 예측하는 것이 아니라 변경을 수용할 수 있는 선택의 여지를 설계에 마련해 놓는 것이다.

> 좋은 설계는 나중에라도 변경할 수 있는 여지를 남겨 놓는 설계다. 설계를 하는 목적은 나중에 설계하는 것을 허용하는 것이며, 설계의 일차적인 목표는 변경에 소요되는 비용을 낮추는 것이다.

변경은 실제로 자주 일어나며, 변경이 일어나지 않는다고 해도 설계를 할 때 변경을 계속 대비하고 어떻게든 변경 비용을 낮추는 방향으로 설계를 하는 것이 좋은 설계라는 생각이 든다.

### 기능을 중심으로 한 설계가 안좋은 이유

기능 분해는 자주 변경되는 기능을 중심으로 설계한 후 구조가 기능에 따르게 한다. 그런데 기능은 자주 변하기 마련이며 큰 기능이 작은 기능들로 분해되고 각 기능이 서로 밀접하게 결합된 구조는 변화에 취약할 수 밖에 없다. 변화에 취약하다는 말은 작은 변경도 서로 강결합된 구조로 인해서 높은 변경 비용을 유발할 여지가 있다는 것이다.

그래서 자주 바뀔 수 있는, 변경의 여지가 큰 기능 보다 변경의 여지가 적은 안정적인 객체 구조를 근간으로 한 설계를 우선하고 기능이 구조를 따르게 하는 것이 좋다.

### 안정적인 재료: 구조

결국 설계는 도메인 모델을 기반으로 이뤄져야 한다. 왜? 도메인 모델이 '본질적'인 설계의 재료이기 때문이다. 여기서 말하는 '본질적'의 의미에 대한 책 문구를 보자.

> 본직적이라는 것은 변경이 적고 비교적 그 특성이 오랜 시간 유지된다는 것을 의미한다.

도메인 모델이 가지고있는 개념과 규칙들은 비교적 변경될 확률이 적기 때문에 이를 재료로 구조를 만들고 기능이 이를 따르게 하는 것이 변경 비용을 최소화 하는 설계라 할 수 있다.



